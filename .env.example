# =====================================
# AUDITSEC - Environment Variables
# =====================================
# Copy this file to .env and fill in your actual values
# This configuration works for both root and backend/

# =====================================
# SERVER & ENVIRONMENT
# =====================================
PORT=3001
NODE_ENV=development

# =====================================
# URLS
# =====================================
# Backend URL (used for OAuth redirects, webhooks)
BACKEND_URL=http://localhost:3001
# Production example: BACKEND_URL=https://api.auditsec.com

# Frontend URL (used for OAuth callback redirects, CORS)
FRONTEND_URL=http://localhost:5173
# Production example: FRONTEND_URL=https://auditsec.com

# =====================================
# DATABASE
# =====================================
# MongoDB (primary database)
ENABLE_MONGO=true
MONGODB_URI=mongodb://localhost:27017/auditsec

# PostgreSQL/Supabase (alternative/migration target)
# DATABASE_URL=postgresql://user:password@host:5432/auditsec
# DATABASE_URL=libsql://your-database.turso.io?authToken=your-token

# SQLite (local dev fallback)
# DATABASE_URL=./auditsec.db

# =====================================
# JWT & AUTHENTICATION
# =====================================
# Generate with: openssl rand -base64 32
JWT_SECRET=your-super-secret-jwt-key-256-bits-minimum

# =====================================
# OAUTH 2.0 PROVIDERS
# =====================================
# Google OAuth
GOOGLE_CLIENT_ID=xxxxxxxx.apps.googleusercontent.com
GOOGLE_CLIENT_SECRET=GOCSPX-xxxxxxxxxxxxxxxxxxxxx

# Microsoft OAuth (optional)
MS_TENANT_ID=common
MS_CLIENT_ID=xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx
MS_CLIENT_SECRET=xxxxxxxx

# Apple Sign-In (optional)
APPLE_CLIENT_ID=com.your.bundle.id
APPLE_CLIENT_SECRET=xxxxxxxx

# =====================================
# STRIPE PAYMENTS
# =====================================
STRIPE_SECRET_KEY=sk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...
STRIPE_PUBLISHABLE_KEY=pk_test_...

# Stripe Price IDs (from Stripe Dashboard)
# STRIPE_PRICE_ID_FREE=price_xxxxxxxxxxxxxxxxxxxxx
# STRIPE_PRICE_ID_PRO=price_xxxxxxxxxxxxxxxxxxxxx
# STRIPE_PRICE_ID_ENTERPRISE=price_xxxxxxxxxxxxxxxxxxxxx

# =====================================
# AWS S3 STORAGE
# =====================================
AWS_ACCESS_KEY_ID=your_access_key
AWS_SECRET_ACCESS_KEY=your_secret_key
AWS_REGION=us-east-1
AWS_S3_BUCKET=auditsec-files

# Cloudflare R2 (S3-compatible alternative)
# AWS_ENDPOINT_URL=https://your-account-id.r2.cloudflarestorage.com

# =====================================
# EMAIL SERVICES
# =====================================
# SMTP (generic)
SMTP_HOST=smtp.gmail.com
SMTP_PORT=465
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password
FROM_EMAIL=noreply@auditsec.com

# SendGrid (alternative)
# SENDGRID_API_KEY=SG.xxxxxxxxxxxxxxxxxxxxx
# SENDGRID_FROM_EMAIL=noreply@auditsec.com

# Mailgun (alternative)
# MAILGUN_API_KEY=key-xxxxxxxxxxxxxxxxxxxxx
# MAILGUN_DOMAIN=mg.auditsec.com

# Resend (alternative)
# RESEND_API_KEY=re_xxxxxxxxxxxxxxxxxxxxx

# =====================================
# SMS SERVICES (for phone auth)
# =====================================
TWILIO_ACCOUNT_SID=ACxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_AUTH_TOKEN=xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx
TWILIO_FROM_NUMBER=+1234567890

# =====================================
# OPENAI / AI ANALYSIS
# =====================================
OPENAI_API_KEY=sk-...
# Recommended default model
OPENAI_MODEL=gpt-4o-mini

# AI vulnerability analysis endpoint (custom/alternative)
# AI_ANALYSIS_ENDPOINT=https://api.openai.com/v1/chat/completions
# AI_ANALYSIS_API_KEY=sk-xxxxxxxxxxxxxxxxxxxxx

# Anthropic Claude (alternative)
# AI_ANALYSIS_ENDPOINT=https://api.anthropic.com/v1/messages
# AI_ANALYSIS_API_KEY=sk-ant-xxxxxxxxxxxxxxxxxxxxx

# =====================================
# REDIS & QUEUE (BullMQ)
# =====================================
REDIS_HOST=localhost
REDIS_PORT=6379
# REDIS_PASSWORD=your-redis-password
# REDIS_TLS=true

# Production Redis (Upstash, Redis Cloud)
# REDIS_URL=redis://default:password@host:6379

# =====================================
# SECURITY & RATE LIMITING
# =====================================
# Rate limiting (requests per window)
RATE_LIMIT_WINDOW_MS=900000
RATE_LIMIT_MAX_REQUESTS=100

# Admin credentials (basic auth for /admin routes)
# ADMIN_USERNAME=admin
# ADMIN_PASSWORD=your-secure-admin-password

# Dev safety: allow scanning localhost without DNS verification
ALLOW_UNVERIFIED_LOCALHOST=true

# =====================================
# DOCKER & SCANNING
# =====================================
# Docker socket (for scan workers)
# DOCKER_SOCKET=/var/run/docker.sock

# Scan resource limits
MAX_SCAN_TIMEOUT_MS=300000
MAX_SCAN_MEMORY_MB=512

# =====================================
# DOWNLOAD LINKS
# =====================================
# Download Link Expiration (in hours)
DOWNLOAD_LINK_EXPIRATION=24

# =====================================
# LOGGING & MONITORING
# =====================================
# Log level (debug, info, warn, error)
LOG_LEVEL=info

# Sentry (error tracking)
# SENTRY_DSN=https://xxxxxxxxxxxxxxxxxxxxx@sentry.io/xxxxxxxxxxxxxxxxxxxxx
